# Документация для проекта "Интернет-магазин"

## 1. Общая информация о проекте

**Название проекта:** Интернет-магазин

**Описание:**  
Проект представляет собой интернет-магазин, где пользователи могут регистрироваться, просматривать товары, добавлять их в корзину, оформлять заказы, оставлять отзывы и ставить оценки. Он предоставляет полный набор функций для управления продуктами, заказами и взаимодействием пользователей с платформой.

---

## 2. Стек технологий

- **Фреймворк бэкенда:** Django с использованием Django Rest Framework (DRF)
- **Аутентификация:** JWT для авторизации пользователей
- **Очередь задач:** Celery для асинхронной отправки email-уведомлений
- **База данных:** PostgreSQL
- **Кэширование и очереди сообщений:** Redis для повышения производительности
- **Swagger:** Автоматическая генерация документации API с использованием drf_yasg

---

## 3. Структура проекта

```plaintext
.
├── account/                    # Управление аккаунтами пользователей
│   ├── models.py               # Модели пользователей и методы активации
│   ├── serializers.py          # Сериализаторы для управления пользователями
│   ├── views.py                # Представления для регистрации, авторизации, активации аккаунта
│   ├── tasks.py                # Задачи Celery для отправки email-уведомлений
│   └── urls.py                 # URL-адреса для работы с аккаунтами
├── apps/                       # Приложения для основных функций магазина
│   ├── order/                  # Управление заказами
│   ├── product/                # Управление товарами
│   └── review/                 # Управление отзывами и рейтингами
├── config/                     # Настройки проекта и конфигурации Celery
│   ├── settings.py             # Основные настройки Django
│   ├── celery_.py              # Конфигурация Celery для асинхронных задач
│   ├── urls.py                 # Основной URL-роутинг
│   └── wsgi.py                 # Точка входа WSGI
└── requirements.txt            # Зависимости проекта
```

---

## 4. Установка

1. **Установите зависимости**:
   - Python 3.11
   - PostgreSQL

2. **Настройка проекта**:
   - **Виртуальная среда**:
     ```bash
     python3 -m venv venv
     source venv/bin/activate
     pip install -r requirements.txt
     ```
   - **Настройка базы данных**:
     - Убедитесь, что PostgreSQL запущен.
     - Создайте базу данных и пользователя:
       ```sql
       CREATE DATABASE shop;
       CREATE USER shop_user WITH PASSWORD 'password';
       ```
   - **Переменные окружения**:
     Создайте файл `.env` в корневой директории со следующими переменными:
     ```env
     DEBUG=False
     DB_NAME=shop
     DB_USER=shop_user
     DB_PASS=password
     DB_HOST=localhost
     EMAIL_HOST_USER=email@example.com
     EMAIL_HOST_PASSWORD=email_password
     ```
   - **Миграции**:
     ```bash
     python manage.py makemigrations
     python manage.py migrate
     ```

3. **Запуск сервера**:
   ```bash
   python manage.py runserver
   ```

---

## 5. Основные функции и API эндпоинты

### 5.1 Управление аккаунтами (`/account/`)

- **Эндпоинты**:
  - `POST /register/`: Регистрация нового пользователя.
  - `GET /activate/<str:email>/<str:activation_code>/`: Активация аккаунта.
  - `POST /login/`: Получение JWT токенов для авторизации.
  - `POST /refresh/`: Обновление JWT токенов.
  - `POST /logout/`: Выход с помощью добавления JWT в черный список.

### 5.2 Управление товарами (`/product/`)

- **Эндпоинты**:
  - `GET /product/`: Просмотр списка товаров с фильтрацией по категории, наличию на складе и цене.
  - `GET /product/<slug>/`: Просмотр детальной информации о товаре.
  - `POST /product/<slug>/like/`: Лайкнуть товар.
  - `POST /product/<slug>/dislike/`: Дизлайкнуть товар.
  - `POST /product/<slug>/favorites/`: Добавить товар в избранное.
  - `POST /product/<slug>/rating/`: Оценить товар.

### 5.3 Управление заказами (`/order/`)

- **Эндпоинты**:
  - `POST /orders/`: Создание нового заказа.
  - `GET /orders/`: Просмотр списка заказов текущего пользователя.
  - `GET /orders/<id>/`: Просмотр деталей конкретного заказа.

### 5.4 Управление отзывами (`/review/`)

- **Эндпоинты**:
  - `POST /comments/`: Добавить новый комментарий к товару.
  - `POST /rating/`: Добавить или изменить оценку товара.
  - `POST /favorites/`: Добавить товар в избранное.

---

## 6. Разрешения

- **AllowAny**: Доступ для всех пользователей (например, просмотр товаров).
- **IsAuthenticated**: Требуется для действий, связанных с личными данными (например, создание заказов, добавление в избранное).
- **IsAdminUser**: Доступ только для администраторов (например, создание и редактирование товаров).
- **IsAuthorPermission**: Проверка на право редактирования контента только для его автора.

---

## 7. Задачи Celery и фоновая обработка

Celery используется для обработки асинхронных задач, таких как отправка писем для активации аккаунта и восстановления пароля.

### Запуск Celery

Для запуска Celery используйте:
```bash
celery -A config worker -l info
```

---

## 8. Кэширование

Для кэширования данных используется Redis, что ускоряет загрузку часто запрашиваемых данных и повышает производительность.

---

## 9. Логирование

Проект использует встроенные средства логирования Django для записи ошибок и событий в файл `debug.log`. Логи позволяют отслеживать ошибки и их возможные причины, упрощая отладку.

---

## 10. Будущие улучшения

- **Рекомендательная система**: Система рекомендаций товаров на основе истории заказов пользователей.
- **Система уведомлений**: Уведомления о скидках, статусах заказов и других обновлениях.
- **Поддержка многовалютности**: Добавление возможности выбора валюты для отображения цен.

---

Эта документация предоставляет основные сведения о проекте, настройках, функционале и планах на будущее.
